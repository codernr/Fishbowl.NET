@page "/"

@inject NavigationManager NavigationManager
@inject IStringLocalizer<Resources> StringLocalizer
@inject GameProperty PersistedGame
@inject IScreenService ScreenService

<StateManager @ref="this.stateManager">
    <Restore
        OnRestoreRequested="this.RestoreGame"
        OnNewGameRequested="_ => this.StateManager.SetStateAsync<PlayerCount>()" />
    <PlayerCount OnPlayerCountSet="this.SetPlayerCount" />
    <TeamCount OnTeamCountSet="this.SetTeamCount" />
    <WordCount OnWordCountSet="this.SetWordCount" />
    <RoundTypes OnRoundTypesSet="this.SetRoundTypes" />
    <PlayerName OnPlayerNameSet="this.SetPlayerName" />
    <PlayerWords OnPlayerWordsSet="this.SetPlayerData" />
    <TeamName OnTeamNameSet="this.SetTeamName" />
    <PeriodSetupPlay OnStarted="this.StartPeriod" />
    <PeriodPlay
        OnScoreAdded="this.AddScore"
        OnPeriodFinished="this.FinishPeriod"
        OnLastScoreRevoked="this.RevokeLastScore" />
    <PeriodFinished Delay="@TimeSpan.FromSeconds(4)" />
    <RoundFinished Delay="@TimeSpan.FromSeconds(4)" />
    <GameFinished ReloadRequested="this.Reload" />
    <Info Delay="@TimeSpan.FromSeconds(2)" />
</StateManager>

<MudPopover Open="this.isPlayerSetupPopoverVisible" AnchorOrigin="Origin.BottomCenter" TransformOrigin="Origin.BottomCenter" Class="pa-5" Paper="false">
    <MudPaper Class="mud-theme-primary pa-2" Elevation="8">
        <MudText>@(string.Format(L("Pages.Play.SetupCount"), this.players.Count + 1))</MudText>
    </MudPaper>
</MudPopover>